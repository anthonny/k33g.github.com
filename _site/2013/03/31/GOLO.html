<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>golo et java</title>
    <meta name="author" content="k33g" />

    <!-- Homepage CSS -->
    <!--
    <link rel="stylesheet" href="http://twitter.github.io/bootstrap/assets/css/bootstrap.css">
    <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
	-->

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
    <link href="/bootstrap3/css/bootstrap.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="bootstrap3/js/bootstrap.min.js"></script>

    <style>
        .jumbotron {
            background-color: #b8eee9;
            border-radius: 0px;
        }
    </style>

    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/css/syntax.css" type="text/css" />
	<link rel="stylesheet" href="/css/default.min.css">


    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>

</head>

<body >

<div class="jumbotron">
    <h1>K33G_ORG's Blog</h1>
    <p></p>
    <a class="label label-info" href="/">home</a>
    <a class="label label-info" href="http://twitter.com/k33g_org/">@k33g_org</a>
    <a class="label label-warning" href="http://feeds.feedburner.com/K33g_orgsBlog">rss</a>
    <a class="label label-info" href="http://k33g.github.com/all.html">all posts</a>
</div>
<div class="container">

    <div class="row">
        <div>
    <div>
        <g:plusone size="medium"></g:plusone>
        <a href="https://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="k33g_org">Tweet</a><script type="text/javascript" src="//platform.twitter.com/widgets.js"></script>
        <h1>Golo &lt;3 Java</h1>

<p>Golo c'est un langage qui "tourne" dans la JVM, il est donc tout naturel qu'il puisse "communiquer" avec elle. C'est à dire ? : Golo peut utiliser toute les fonctionnalités embarquées de java (les packages de base), mais aussi des librairies externes (des jars d'autres frameworks, ou les votres), on parle bien sûr ici, d'INTEROPERABILITE.</p>

<h2>Golo et Java, utiliser les fonctionnalités de base</h2>

<h3>Exemple : Les Strings &amp; co</h3>

<p>Alors de fait vous les utilisez dans Golo : <code>var hello = "hello world !"</code> mais aussi avec les objets dans Golo qui "portent" les primitives de base :</p>

<div class="highlight"><pre><code class="coffeescript"><span class="nx">var</span> <span class="nv">age = </span><span class="mi">42</span>
<span class="nx">var</span> <span class="nv">geekAge = age: </span><span class="nx">toString</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot; ans&quot;</span>
</code></pre></div>


<p>Cet exemple est crétin on peut très bien caster directement :</p>

<div class="highlight"><pre><code class="coffeescript"><span class="nx">var</span> <span class="nv">age = </span><span class="mi">42</span>
<span class="nx">var</span> <span class="nv">geekAge = </span><span class="nx">age</span> <span class="o">+</span> <span class="s">&quot; ans&quot;</span>
</code></pre></div>


<p>Mais vous pouvez aussi utiliser les méthodes statiques de l'objet <code>String</code> :</p>

<div class="highlight"><pre><code class="coffeescript"><span class="nx">import</span> <span class="nx">java</span><span class="p">.</span><span class="nx">lang</span><span class="p">.</span><span class="nb">String</span>

<span class="nx">function</span> <span class="nv">main = </span><span class="o">|</span><span class="nx">args</span><span class="o">|</span> <span class="p">{</span>

    <span class="nx">println</span><span class="p">(</span><span class="nb">String</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="s">&quot;Hello i am %s&quot;</span><span class="p">,</span> <span class="s">&quot;@K33G_ORG&quot;</span><span class="p">))</span>

<span class="p">}</span>
</code></pre></div>


<p><strong>Retenez bien</strong> :</p>

<ul>
<li>on utilise le <code>.</code> pour accéder aux membres statiques et <code>:</code> pour les membres d'instances. Ca surprend au début, mais en fait on y gagne en lisibilité</li>
<li>n'oubliez pas le <code>import java.lang.String</code> sinon ça ne marchera pas</li>
</ul>


<h3>Autre exemple : les HashMaps</h3>

<p>Je voue une passion inconsidérée et inexpliquées aux HashMaps, donc un petit exemple avant de rentrer dans le dur</p>

<div class="highlight"><pre><code class="coffeescript"><span class="nx">import</span> <span class="nx">java</span><span class="p">.</span><span class="nx">lang</span><span class="p">.</span><span class="nb">String</span>
<span class="nx">import</span> <span class="nx">java</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">HashMap</span>

<span class="nx">function</span> <span class="nv">main = </span><span class="o">|</span><span class="nx">args</span><span class="o">|</span> <span class="p">{</span>

    <span class="nx">var</span> <span class="nv">heroes = </span><span class="nx">HashMap</span><span class="p">()</span> <span class="c1"># = new HashMap()</span>

    <span class="nv">heroes: </span><span class="nx">put</span><span class="p">(</span><span class="s">&quot;CB&quot;</span><span class="p">,</span> <span class="s">&quot;Claire Bennet&quot;</span><span class="p">)</span>
    <span class="nv">heroes: </span><span class="nx">put</span><span class="p">(</span><span class="s">&quot;HN&quot;</span><span class="p">,</span> <span class="s">&quot;Hiro Nakamura&quot;</span><span class="p">)</span>
    <span class="nv">heroes: </span><span class="nx">put</span><span class="p">(</span><span class="s">&quot;PP&quot;</span><span class="p">,</span> <span class="s">&quot;Peter Petrelli&quot;</span><span class="p">)</span>

    <span class="nx">foreach</span><span class="p">(</span><span class="nx">heroe</span> <span class="k">in</span> <span class="nv">heroes: </span><span class="nx">entrySet</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">println</span><span class="p">(</span>
            <span class="nb">String</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="s">&quot;key : %s -&gt; name : %s&quot;</span><span class="p">,</span> 
                <span class="nv">heroe: </span><span class="nx">getKey</span><span class="p">(),</span> 
                <span class="nv">heroe: </span><span class="nx">getValue</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="p">)</span>    
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>vous obtiendrez donc :</p>

<pre><code>key : PP -&gt; name : Peter Petrelli
key : HN -&gt; name : Hiro Nakamura
key : CB -&gt; name : Claire Bennet
</code></pre>

<p>Donc, vous voyez, on dispose de la puissance de Java au service de Golo! :)
Mais passons à plus fun.</p>

<h2>Golo &amp; les librairies externes</h2>

<h3>Faites votre jar : jouons au pays ACME avec Buster</h3>

<p>Nous allons faire notre propre librairie, comme cela vous pourrez la modifier à loisir pour vos expérimentations. Nous avons côté Java :</p>

<h4>Une interface Toon.java</h4>

<div class="highlight"><pre><code class="java"><span class="kn">package</span> <span class="n">acme</span><span class="o">.</span><span class="na">looniversity</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Toon</span> <span class="o">{</span>
    <span class="n">String</span> <span class="nf">name</span><span class="o">();</span>
    <span class="kt">void</span> <span class="nf">name</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">);</span>
    <span class="n">String</span> <span class="nf">description</span><span class="o">();</span>
    <span class="kt">void</span> <span class="nf">description</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">);</span>

    <span class="kt">void</span> <span class="nf">talk</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">);</span>
    <span class="kt">void</span> <span class="nf">run</span><span class="o">();</span>
    <span class="kt">void</span> <span class="nf">scream</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>


<h4>Une classe TinyToon.java (qui implémente Toon)</h4>

<div class="highlight"><pre><code class="java"><span class="kn">package</span> <span class="n">acme</span><span class="o">.</span><span class="na">looniversity</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TinyToon</span> <span class="kd">implements</span> <span class="n">Toon</span><span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;John Doe&quot;</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">description</span><span class="o">=</span><span class="s">&quot;Somebody&quot;</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">age</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">age</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">age</span><span class="o">;</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">age</span><span class="o">(</span><span class="kt">int</span> <span class="n">age</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">age</span> <span class="o">=</span> <span class="n">age</span><span class="o">;</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">name</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">name</span><span class="o">;</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">name</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">description</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">description</span><span class="o">;</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">description</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">description</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">talk</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">+</span> <span class="s">&quot; is talking : &quot;</span><span class="o">+</span> <span class="n">message</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">+</span> <span class="s">&quot; is running&quot;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">scream</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">+</span> <span class="s">&quot; is screaming&quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>


<h4>Un singleton BusterBunny.java</h4>

<div class="highlight"><pre><code class="java"><span class="kn">package</span> <span class="n">acme</span><span class="o">.</span><span class="na">looniversity</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BusterBunny</span> <span class="kd">extends</span> <span class="n">TinyToon</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">BusterBunny</span> <span class="n">theOnlyOne</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nf">BusterBunny</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">&quot;Buster Bunny&quot;</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">description</span><span class="o">(</span><span class="s">&quot;a blue male rabbit&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">BusterBunny</span> <span class="nf">getInstance</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">BusterBunny</span><span class="o">.</span><span class="na">theOnlyOne</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">BusterBunny</span><span class="o">.</span><span class="na">theOnlyOne</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BusterBunny</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">BusterBunny</span><span class="o">.</span><span class="na">theOnlyOne</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>


<h3>Jouons avec Buster</h3>

<p>Vous me faites un jar <code>tinytools.jar</code> avec les codes java ci-dessus, puis vs créez un nouveau script golo <code>acme.golo</code> (au même endroit que le jar pour le moment) :</p>

<h4>acme.golo</h4>

<div class="highlight"><pre><code class="coffeescript"><span class="nx">module</span> <span class="nx">acme</span>

<span class="nx">import</span> <span class="nx">acme</span><span class="p">.</span><span class="nx">looniversity</span><span class="p">.</span><span class="nx">BusterBunny</span>

<span class="nx">function</span> <span class="nv">main = </span><span class="o">|</span><span class="nx">args</span><span class="o">|</span> <span class="p">{</span>

    <span class="nx">var</span> <span class="nv">buster = </span><span class="nx">BusterBunny</span><span class="p">.</span><span class="nx">getInstance</span><span class="p">()</span> <span class="c1">#call static method</span>

    <span class="nv">buster: </span><span class="nx">run</span><span class="p">()</span>
    <span class="nv">buster: </span><span class="nx">scream</span><span class="p">()</span>
    <span class="nv">buster: </span><span class="nx">talk</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">)</span>

    <span class="nx">println</span><span class="p">(</span><span class="s">&quot;buster name : &quot;</span> <span class="o">+</span> <span class="nv">buster: </span><span class="nx">name</span><span class="p">())</span>
    <span class="nx">println</span><span class="p">(</span><span class="s">&quot;buster description : &quot;</span> <span class="o">+</span> <span class="nv">buster: </span><span class="nx">description</span><span class="p">())</span>

    <span class="nv">buster: </span><span class="nx">age</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>

    <span class="nx">var</span> <span class="nv">busterAgain = </span><span class="nx">BusterBunny</span><span class="p">.</span><span class="nx">getInstance</span><span class="p">()</span>

    <span class="nx">println</span><span class="p">(</span><span class="s">&quot;Age : &quot;</span> <span class="o">+</span> <span class="nv">busterAgain: </span><span class="nx">age</span><span class="p">())</span> <span class="c1">#it&#39;s a singleton</span>

<span class="p">}</span>
</code></pre></div>


<p>Pour exécuter ce script en précisant le fichier <code>tinytools.jar</code> utilisé , créez un script <code>acme.sh</code> (et rendez-le exécutable <code>chmod +x</code>) :</p>

<pre><code>#!/bin/sh

export CLASSPATH_PREFIX=${CLASSPATH_PREFIX}:tinytools.jar

gologolo $1 
</code></pre>

<p>Maintenant, lancez <code>./acme.sh acme.golo</code> et vous allez obtenir :</p>

<pre><code>Buster Bunny is running
Buster Bunny is screaming
Buster Bunny is talking : Hello
buster name : Buster Bunny
buster description : a blue male rabbit
Age : 13
</code></pre>

<h4>Explications</h4>

<ul>
<li><code>var buster = BusterBunny.getInstance()</code> on appelle la méthode <strong>statique</strong> <code>getInstance()</code> pour avoir une instance (et la seule) de Buster</li>
<li><code>buster: age(13)</code> : on change l'age de Buster en utilisant une méthode d'instance</li>
<li><code>var busterAgain = BusterBunny.getInstance()</code> on essaye d'avoir une 2ème instance de Buster</li>
<li>et en fait c'est bien la même (un singleton donc) puisque l'on s'aperçoit que l'age de <code>busterAgain</code> est déjà égal à 13</li>
</ul>


<h3>Buster veut une copine, l'héritage cémal, la composition c'est bon</h3>

<p>En Golo, hériter d'une classe Java n'est pas possible (pour le moment), mais nous allons voir que ce n'est pas forcément utile. Je pourrais faire une classe java <code>BabsBunny</code>, mais je n'ai pas envie de refaire ma librairie java, donc je vais jouer avec les <strong>DynamicObjects</strong> (encore, mais j'aime tellement ça) et la <strong>composition</strong> et une sorte de pattern <strong>proxy</strong>. Modifiez donc le code de <code>acme.golo</code> :</p>

<div class="highlight"><pre><code class="coffeescript"><span class="nx">module</span> <span class="nx">acme</span>

<span class="nx">import</span> <span class="nx">acme</span><span class="p">.</span><span class="nx">looniversity</span><span class="p">.</span><span class="nx">TinyToon</span>

<span class="nx">function</span> <span class="nv">BabsBunny = </span><span class="nf">-&gt;</span> <span class="nx">DynamicObject</span><span class="p">()</span><span class="o">:</span>
    <span class="nx">acmeInstance</span><span class="p">(</span><span class="nx">TinyToon</span><span class="p">())</span><span class="o">:</span>
    <span class="nx">define</span><span class="p">(</span><span class="s">&quot;init&quot;</span><span class="p">,</span> <span class="o">|</span><span class="k">this</span><span class="o">|</span> <span class="p">{</span>
        <span class="k">this</span><span class="o">:</span> <span class="nx">acmeInstance</span><span class="p">()</span><span class="o">:</span> <span class="nx">name</span><span class="p">(</span><span class="s">&quot;Babs Bunny&quot;</span><span class="p">)</span>
        <span class="k">this</span><span class="o">:</span> <span class="nx">acmeInstance</span><span class="p">()</span><span class="o">:</span> <span class="nx">description</span><span class="p">(</span><span class="s">&quot;a pink female rabbit&quot;</span><span class="p">)</span>
        <span class="k">this</span><span class="o">:</span> <span class="nx">acmeInstance</span><span class="p">()</span><span class="o">:</span> <span class="nx">age</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">this</span>
    <span class="p">})</span><span class="o">:</span>
    <span class="nx">define</span><span class="p">(</span><span class="s">&quot;age&quot;</span><span class="p">,</span> <span class="o">|</span><span class="k">this</span><span class="o">|</span> <span class="nf">-&gt;</span> <span class="k">this</span><span class="o">:</span> <span class="nx">acmeInstance</span><span class="p">()</span><span class="o">:</span> <span class="nx">age</span><span class="p">())</span><span class="o">:</span>
    <span class="nx">define</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="o">|</span><span class="k">this</span><span class="o">|</span> <span class="nf">-&gt;</span> <span class="k">this</span><span class="o">:</span> <span class="nx">acmeInstance</span><span class="p">()</span><span class="o">:</span> <span class="nx">name</span><span class="p">())</span><span class="o">:</span>
    <span class="nx">define</span><span class="p">(</span><span class="s">&quot;description&quot;</span><span class="p">,</span> <span class="o">|</span><span class="k">this</span><span class="o">|</span> <span class="nf">-&gt;</span> <span class="k">this</span><span class="o">:</span> <span class="nx">acmeInstance</span><span class="p">()</span><span class="o">:</span> <span class="nx">description</span><span class="p">())</span><span class="o">:</span>
    <span class="nx">define</span><span class="p">(</span><span class="s">&quot;run&quot;</span><span class="p">,</span> <span class="o">|</span><span class="k">this</span><span class="o">|</span> <span class="nf">-&gt;</span> <span class="k">this</span><span class="o">:</span> <span class="nx">acmeInstance</span><span class="p">()</span><span class="o">:</span> <span class="nx">run</span><span class="p">())</span><span class="o">:</span>
    <span class="nx">define</span><span class="p">(</span><span class="s">&quot;scream&quot;</span><span class="p">,</span> <span class="o">|</span><span class="k">this</span><span class="o">|</span> <span class="nf">-&gt;</span> <span class="k">this</span><span class="o">:</span> <span class="nx">acmeInstance</span><span class="p">()</span><span class="o">:</span> <span class="nx">scream</span><span class="p">())</span><span class="o">:</span>
    <span class="nx">define</span><span class="p">(</span><span class="s">&quot;talk&quot;</span><span class="p">,</span> <span class="o">|</span><span class="k">this</span><span class="p">,</span> <span class="nx">message</span><span class="o">|</span> <span class="nf">-&gt;</span> <span class="k">this</span><span class="o">:</span> <span class="nx">acmeInstance</span><span class="p">()</span><span class="o">:</span> <span class="nx">talk</span><span class="p">(</span><span class="nx">message</span><span class="p">))</span>



<span class="nx">function</span> <span class="nv">main = </span><span class="o">|</span><span class="nx">args</span><span class="o">|</span> <span class="p">{</span>

    <span class="nx">var</span> <span class="nv">babs = </span><span class="nx">BabsBunny</span><span class="p">()</span><span class="o">:</span> <span class="nx">init</span><span class="p">()</span>

    <span class="nv">babs: </span><span class="nx">run</span><span class="p">()</span>
    <span class="nv">babs: </span><span class="nx">scream</span><span class="p">()</span>
    <span class="nv">babs: </span><span class="nx">talk</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">)</span>

    <span class="nx">println</span><span class="p">(</span><span class="s">&quot;babs name : &quot;</span> <span class="o">+</span> <span class="nv">babs: </span><span class="nx">name</span><span class="p">())</span>
    <span class="nx">println</span><span class="p">(</span><span class="s">&quot;babs description : &quot;</span> <span class="o">+</span> <span class="nv">babs: </span><span class="nx">description</span><span class="p">())</span>  

    <span class="nx">println</span><span class="p">(</span><span class="s">&quot;Age of babs : &quot;</span> <span class="o">+</span> <span class="nv">babs: </span><span class="nx">age</span><span class="p">())</span>

<span class="p">}</span>
</code></pre></div>


<p>J'ai donc ajouté un DynamicObject <code>BabsBunny</code> qui a une propriété <code>acmeInstance</code> "contenant" une instance de la classe java <code>TinyToon</code> et ensuite je reproduis les comportements de cette classe en créant des méthodes qui appellent les méthodes de la classe java.</p>

<p>Vous pouvez lancer <code>./acme.sh acme.golo</code> et vous allez obtenir :</p>

<pre><code>Babs Bunny is running
Babs Bunny is screaming
Babs Bunny is talking : Hello
babs name : Babs Bunny
babs description : a pink female rabbit
Age of babs : 12
</code></pre>

<h4>La même chose mais avec des mixins car il y a beaucoup de Tinytoons au pays ACME</h4>

<p>Parce que le pays ACME n'est pas uniquement habité par Babs et Buster, que le copier/coller cémal, je vais faire un peu de refactoring de code :</p>

<p>Je vais créer un DynamicObject <code>_TinyToon_</code> dont tous mes golo tinytoons hériteront via <code>mixin()</code> :</p>

<div class="highlight"><pre><code class="coffeescript"><span class="nx">module</span> <span class="nx">acme</span>

<span class="nx">import</span> <span class="nx">acme</span><span class="p">.</span><span class="nx">looniversity</span><span class="p">.</span><span class="nx">TinyToon</span>
<span class="nx">import</span> <span class="nx">java</span><span class="p">.</span><span class="nx">lang</span><span class="p">.</span><span class="nb">String</span>

<span class="c1">#an other way to get a Babs Bunny</span>

<span class="nx">function</span> <span class="nv">_TinyToon_ = </span><span class="nf">-&gt;</span> <span class="nx">DynamicObject</span><span class="p">()</span><span class="o">:</span>
    <span class="nx">acmeInstance</span><span class="p">(</span><span class="nx">TinyToon</span><span class="p">())</span><span class="o">:</span>
    <span class="nx">define</span><span class="p">(</span><span class="s">&quot;super&quot;</span><span class="p">,</span> <span class="o">|</span><span class="k">this</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">description</span><span class="p">,</span> <span class="nx">age</span><span class="o">|</span> <span class="p">{</span>
        <span class="k">this</span><span class="o">:</span> <span class="nx">acmeInstance</span><span class="p">()</span><span class="o">:</span> <span class="nx">name</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
        <span class="k">this</span><span class="o">:</span> <span class="nx">acmeInstance</span><span class="p">()</span><span class="o">:</span> <span class="nx">description</span><span class="p">(</span><span class="nx">description</span><span class="p">)</span>
        <span class="k">this</span><span class="o">:</span> <span class="nx">acmeInstance</span><span class="p">()</span><span class="o">:</span> <span class="nx">age</span><span class="p">(</span><span class="nx">age</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">this</span>
    <span class="p">})</span><span class="o">:</span>
    <span class="nx">define</span><span class="p">(</span><span class="s">&quot;age&quot;</span><span class="p">,</span> <span class="o">|</span><span class="k">this</span><span class="o">|</span> <span class="nf">-&gt;</span> <span class="k">this</span><span class="o">:</span> <span class="nx">acmeInstance</span><span class="p">()</span><span class="o">:</span> <span class="nx">age</span><span class="p">())</span><span class="o">:</span>
    <span class="nx">define</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="o">|</span><span class="k">this</span><span class="o">|</span> <span class="nf">-&gt;</span> <span class="k">this</span><span class="o">:</span> <span class="nx">acmeInstance</span><span class="p">()</span><span class="o">:</span> <span class="nx">name</span><span class="p">())</span><span class="o">:</span>
    <span class="nx">define</span><span class="p">(</span><span class="s">&quot;description&quot;</span><span class="p">,</span> <span class="o">|</span><span class="k">this</span><span class="o">|</span> <span class="nf">-&gt;</span> <span class="k">this</span><span class="o">:</span> <span class="nx">acmeInstance</span><span class="p">()</span><span class="o">:</span> <span class="nx">description</span><span class="p">())</span><span class="o">:</span>
    <span class="nx">define</span><span class="p">(</span><span class="s">&quot;run&quot;</span><span class="p">,</span> <span class="o">|</span><span class="k">this</span><span class="o">|</span> <span class="nf">-&gt;</span> <span class="k">this</span><span class="o">:</span> <span class="nx">acmeInstance</span><span class="p">()</span><span class="o">:</span> <span class="nx">run</span><span class="p">())</span><span class="o">:</span>
    <span class="nx">define</span><span class="p">(</span><span class="s">&quot;scream&quot;</span><span class="p">,</span> <span class="o">|</span><span class="k">this</span><span class="o">|</span> <span class="nf">-&gt;</span> <span class="k">this</span><span class="o">:</span> <span class="nx">acmeInstance</span><span class="p">()</span><span class="o">:</span> <span class="nx">scream</span><span class="p">())</span><span class="o">:</span>
    <span class="nx">define</span><span class="p">(</span><span class="s">&quot;talk&quot;</span><span class="p">,</span> <span class="o">|</span><span class="k">this</span><span class="p">,</span> <span class="nx">message</span><span class="o">|</span> <span class="nf">-&gt;</span> <span class="k">this</span><span class="o">:</span> <span class="nx">acmeInstance</span><span class="p">()</span><span class="o">:</span> <span class="nx">talk</span><span class="p">(</span><span class="nx">message</span><span class="p">))</span>


<span class="nx">function</span> <span class="nv">BabsBunny = </span><span class="nf">-&gt;</span> <span class="nx">DynamicObject</span><span class="p">()</span><span class="o">:</span>
    <span class="nx">mixin</span><span class="p">(</span><span class="nx">_TinyToon_</span><span class="p">())</span><span class="o">:</span>
    <span class="nx">define</span><span class="p">(</span><span class="s">&quot;init&quot;</span><span class="p">,</span> <span class="o">|</span><span class="k">this</span><span class="o">|</span> <span class="p">{</span>
        <span class="k">this</span><span class="o">:</span> <span class="k">super</span><span class="p">(</span><span class="s">&quot;Babs Bunny&quot;</span><span class="p">,</span> <span class="s">&quot;a pink female rabbit&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">this</span>
    <span class="p">})</span>

<span class="nx">function</span> <span class="nv">ElmyraDuff = </span> <span class="nf">-&gt;</span> <span class="nx">DynamicObject</span><span class="p">()</span><span class="o">:</span>
    <span class="nx">mixin</span><span class="p">(</span><span class="nx">_TinyToon_</span><span class="p">())</span><span class="o">:</span>
    <span class="nx">define</span><span class="p">(</span><span class="s">&quot;init&quot;</span><span class="p">,</span> <span class="o">|</span><span class="k">this</span><span class="o">|</span> <span class="p">{</span>
        <span class="k">this</span><span class="o">:</span> <span class="k">super</span><span class="p">(</span><span class="s">&quot;Elmira Duff&quot;</span><span class="p">,</span> <span class="s">&quot;a kid, redheaded, female human&quot;</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">this</span>
    <span class="p">})</span><span class="o">:</span>
    <span class="nx">define</span><span class="p">(</span><span class="s">&quot;chases&quot;</span><span class="p">,</span> <span class="o">|</span><span class="k">this</span><span class="p">,</span> <span class="nx">toon</span><span class="o">|</span> <span class="p">{</span>
        <span class="nx">println</span><span class="p">(</span><span class="nb">String</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="s">&quot;Help ! I&#39;m %s : %s, i&#39;m chased by Elmira :(&quot;</span><span class="p">,</span><span class="nv">toon: </span><span class="nx">name</span><span class="p">(),</span><span class="nv">toon: </span><span class="nx">description</span><span class="p">()))</span>
    <span class="p">})</span>

<span class="nx">function</span> <span class="nv">main = </span><span class="o">|</span><span class="nx">args</span><span class="o">|</span> <span class="p">{</span>

    <span class="nx">var</span> <span class="nv">babs = </span><span class="nx">BabsBunny</span><span class="p">()</span><span class="o">:</span> <span class="nx">init</span><span class="p">()</span>

    <span class="nx">var</span> <span class="nv">elmira = </span><span class="nx">ElmyraDuff</span><span class="p">()</span><span class="o">:</span> <span class="nx">init</span><span class="p">()</span>

    <span class="nv">elmira: </span><span class="nx">chases</span><span class="p">(</span><span class="nx">babs</span><span class="p">)</span>

<span class="p">}</span>
</code></pre></div>


<p>Encore une fois lancez <code>./acme.sh acme.golo</code> et vous allez obtenir :</p>

<pre><code>Help ! I'm Babs Bunny : a pink female rabbit, i'm chased by Elmira :(
</code></pre>

<h2>Java aussi peut utiliser Golo, mais ...</h2>

<p>Là aussi, c'est possible, mais je ne vais pas m'étendre sur le sujet cette fois-ci, car ça peut faire un prochain article complet (ie: une application java scriptable en Golo), en attendant vous pouvez aller lire la documentation sur le sujet <a href="http://golo-lang.org/documentation/next/#_golo_class_loader">http://golo-lang.org/documentation/next/#_golo_class_loader</a>.</p>

<h2>Conclusion</h2>

<p><strong>"Si vous ne savez pas le faire en Golo, vous pourrez le faire en Java ... Mais en Golo vous pouvez en faire un maximum."</strong></p>

<p><em>42.</em></p>

        <g:plusone size="medium"></g:plusone>
        <a href="https://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="k33g_org">Tweet</a><script type="text/javascript" src="//platform.twitter.com/widgets.js"></script>
    </div>
    <div class="whoring">
        <hr>
        <div id="disqus_thread"></div>
            <script type="text/javascript">
                /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                var disqus_shortname = 'k33gblog'; // required: replace example with your forum shortname

                var disqus_identifier = 'golo et java';

                // The following are highly recommended additional parameters. Remove the slashes in front to use.
                // var disqus_identifier = 'unique_dynamic_id_1234';
                // var disqus_url = 'http://example.com/permalink-to-page.html';

                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

    </div>


    <div id="related">
        <h2>Related Posts</h2>
            <ul class="posts">
            
              <li><span>10 Dec 2013</span> &raquo; <a href="/2013/12/10/POLYMER-2.html">Polymer 1er contact le retour</a></li>
            
              <li><span>07 Dec 2013</span> &raquo; <a href="/2013/12/07/POLYMER-1.html">Polymer 1er contact</a></li>
            
              <li><span>29 Nov 2013</span> &raquo; <a href="/2013/11/29/BBOM.html">Le modèle objet de Backbone</a></li>
            
        </ul>
    </div>
</div>
    </div>

    <div class="row">
        <h3>A voir : Les GROS tutos Play!> 1 & 2 !, Backbone</h3>
        <ul>
            <li>
                <a href="http://3monkeys.github.com/play.rules/livre.play.deux.web/play2.rules.return.html">
                    Play!► 2 en douceur •
                </a>
                <a href="http://3monkeys.github.com/play.rules/livre.play.un.web/play.rules.one.html">
                    Apprendre Play!► 1 •
                </a>
                <a href="http://3monkeys.github.com/play.rules/">
                    Versions epub & pdf
                </a>
            </li>
            <li>
                <a href="http://k33g.github.io/backbone.en.douceur/">
                    Backbone.js "en douceur" •
                </a>
                <a href="http://k33g.github.io/backbone.en.douceur/backbone.en.douceur.20121220.pdf"><b>LE</b> pdf</a>
            </li>
            <li>
                A venir : Golo "dans tous les sens" ♥
            </li>
        </ul>
    </div>
    <hr>

</div>



<!-- Google Analytics -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-11383603-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<!-- Google Analytics end -->

</body>
</html>